Declare @CollectionID as Varchar(8)

Set @CollectionID = 'SMS00001'

select 'Last Reboot within 7 days' as TimePeriod,Count(sys.Name0) as 'Count',1 SortOrder

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where os.LastBootUpTime0 < DATEADD(day,-7, GETDATE())

and ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

UNION

select 'Last Reboot within 14 days' as TimePeriod,Count(sys.Name0) as 'Count',2

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where os.LastBootUpTime0 < DATEADD(day,-14, GETDATE())

and ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

UNION

select 'Last Reboot within 1 month' as TimePeriod,Count(sys.Name0) as 'Count',3

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where os.LastBootUpTime0 < DATEADD(month,-1, GETDATE())

and ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

UNION

select 'Last Reboot within 3 months' as TimePeriod,Count(sys.Name0) as 'Count',4

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where os.LastBootUpTime0 < DATEADD(month,-3, GETDATE())

and ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

UNION

select 'Last Reboot within 6 months' as TimePeriod,Count(sys.Name0) as 'Count',5

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where os.LastBootUpTime0 < DATEADD(month,-6, GETDATE())

and ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

UNION

select 'Last Reboot within 12 months' as TimePeriod,Count(sys.Name0) as 'Count',6

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where os.LastBootUpTime0 < DATEADD(month,-12, GETDATE())

and ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

UNION

select 'Total Machines Count' as TimePeriod,Count(sys.Name0) as 'Count',7

from v_R_System sys

inner join v_GS_OPERATING_SYSTEM os on os.ResourceId = sys.ResourceId

inner join v_FullCollectionMembership Vf on sys.ResourceID = Vf.ResourceID

inner join v_CH_ClientSummary ch on ch.ResourceID = sys.ResourceID

where ch.ClientActiveStatus = 1 and sys.Operating_System_Name_and0 like '%workstation%'

and Vf.CollectionID = @CollectionID

Order By SortOrder
